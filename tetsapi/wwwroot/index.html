<!DOCTYPE HTML>

<html>

<head>
   <link rel="stylesheet" href="index.css">
   <script type="text/javascript">
      function WebSocketTest() {

         var ewedevice;

         if ("WebSocket" in window) {
            // Let us open a web socket
            var ws = new WebSocket("ws://localhost:5094/ws");

            ws.onopen = function () {

               // Web Socket is connected, send data using send()
               ws.send("Im sending you a message!");
               // alert("Message is sent...");
            };

            ws.onmessage = function (evt) {
               var received_msg = evt.data;
               console.log(received_msg);
               // var ewedevice = JSON.parse(received_msg);
               if (received_msg) {
                  try {
                     ewedevice = JSON.parse(received_msg);
                     if (ewedevice.params.switch !== undefined) {
                        document.getElementById("switch1").checked = ewedevice.params.switch === "on";
                     }
                  } catch (e) {
                     console.log(e);
                  }
               }

               // alert(received_msg);
            };

            ws.onclose = function () {

               // websocket is closed.
               alert("Connection is closed...");
            };
         } else {

            // The browser doesn't support WebSocket
            alert("WebSocket NOT supported by your Browser!");
         }
      }      
   </script>

</head>

<body>
   <!-- <div id="sse">
      <a href="javascript:WebSocketTest()">Run WebSocket</a>
   </div> -->
   <section class="centered">
      <h2>Toggle Signboard Switch</h2>
      <label class="switch">
         <input id="switch1" type="checkbox" readonly>
         <span class="slider round"></span>
      </label>
   </section>

</body>

<script type="text/javascript">
   window.onload = function () {
      WebSocketTest();
   };
</script>

</html>